<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q-CHOP vs. Standard Adiabatic Approach</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for NVIDIA branding */
        .nvidia-green {
            background-color: #76b900;
        }
        .nvidia-green-text {
            color: #76b900;
        }
        .nvidia-purple {
            background-color: #7a00ff;
        }
        .nvidia-dark {
            background-color: #2A2A2A;
        }
        /* Style for disabled buttons */
        button:disabled {
            background-color: #4a4a4a;
            cursor: not-allowed;
            opacity: 0.6;
        }
        /* Custom animation for button hover */
        button {
            transition: all 0.3s ease;
        }
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="nvidia-dark text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-6xl bg-[#333333] rounded-2xl shadow-2xl p-6 md:p-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold nvidia-green-text">Q-CHOP Optimization</h1>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <div>
                <h2 class="text-xl font-semibold text-center mb-4">Q-CHOP converges to best feasible state</h2>
                <div class="relative h-80 w-full mb-6">
                    <canvas id="bestStateChart"></canvas>
                </div>
            </div>

            <div>
                <h2 class="text-xl font-semibold text-center mb-4">Q-CHOP converges to worst feasible state</h2>
                <div class="relative h-80 w-full mb-6">
                    <canvas id="worstStateChart"></canvas>
                </div>
            </div>

        </div>

        <div class="text-center mt-8">
            <h3 class="text-lg font-semibold text-gray-200">In both cases, Q-CHOP converges faster to a higher quality solution</h3>
        </div>

        <div class="mt-6 flex flex-col items-center justify-center gap-6">
            <div id="controls" class="flex gap-4">
                <button id="initializeBtn" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg shadow-md">
                    Initialize
                </button>
                <button id="startRun1Btn" class="nvidia-green text-black font-bold py-2 px-6 rounded-lg shadow-md hidden">
                    Start first Q-CHOP run
                </button>
                <button id="startRun2Btn" class="nvidia-purple text-white font-bold py-2 px-6 rounded-lg shadow-md hidden">
                    Start second Q-CHOP run
                </button>
            </div>
            <div class="flex flex-wrap justify-center gap-x-4 gap-y-2 text-sm">
                <div class="flex items-center">
                    <span class="h-4 w-4 rounded-full mr-2" style="background-color: #76b900;"></span>
                    <span>Q-CHOP Run 1</span>
                </div>
                 <div class="flex items-center">
                    <span class="h-4 w-4 rounded-full mr-2" style="background-color: #7a00ff;"></span>
                    <span>Q-CHOP Run 2</span>
                </div>
                <div class="flex items-center">
                    <span class="h-4 w-4 rounded-full mr-2" style="background-color: #a0a0a0;"></span>
                    <span>Standard Adiabatic</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA SETUP ---
        // Data for "Best State" Chart
        const bestTimeData = [0.00, 5.00, 10.00, 15.00, 20.00, 25.00, 30.00, 35.00, 40.00, 45.00, 50.00, 55.00, 60.00, 65.00, 70.00, 75.00, 80.00, 85.00, 90.00, 95.00, 100.00, 105.00, 110.00, 115.00, 120.00, 125.00, 130.00, 135.00, 140.00, 145.00, 150.00, 155.00, 160.00, 165.00, 170.00, 175.00, 180.00, 185.00, 190.00, 195.00, 200.00, 205.00, 210.00, 215.00, 220.00, 225.00, 230.00, 235.00, 240.00, 245.00, 250.00, 255.00, 260.00, 265.00, 270.00, 275.00, 280.00, 285.00, 290.00, 295.00, 300.00, 305.00, 310.00, 315.00, 320.00, 325.00, 330.00, 335.00, 340.00, 345.00, 350.00, 355.00, 360.00, 365.00, 370.00, 375.00, 380.00, 385.00, 390.00, 395.00, 400.00, 405.00, 410.00, 415.00, 420.00, 425.00, 430.00, 435.00, 440.00, 445.00, 450.00, 455.00, 460.00, 465.00, 470.00, 475.00, 480.00, 485.00, 490.00, 495.00, 500.00, 505.00, 510.00, 515.00, 520.00, 525.00, 530.00, 535.00, 540.00, 545.00, 550.00, 555.00, 560.00, 565.00, 570.00, 575.00, 580.00, 585.00, 590.00, 595.00, 600.00, 605.00, 610.00, 615.00, 620.00, 625.00, 630.00, 635.00, 640.00, 645.00, 650.00, 655.00, 660.00, 665.00, 670.00, 675.00, 680.00, 685.00, 690.00, 695.00, 700.00, 705.00, 710.00, 715.00, 720.00, 725.00, 730.00, 735.00, 740.00, 745.00, 750.00, 755.00, 760.00, 765.00, 770.00, 775.00, 780.00, 785.00, 790.00, 795.00, 800.00, 805.00, 810.00, 815.00, 820.00, 825.00, 830.00, 835.00, 840.00, 845.00, 850.00, 855.00, 860.00, 865.00, 870.00, 875.00, 880.00, 885.00, 890.00, 895.00, 900.00, 905.00, 910.00, 915.00, 920.00, 925.00, 930.00, 935.00, 940.00, 945.00, 950.00, 955.00, 960.00, 965.00, 970.00, 975.00, 980.00, 985.00, 990.00, 995.00, 1000.00];
        const bestQChopData = [0.01466, 0.01468, 0.01491, 0.01573, 0.01741, 0.01986, 0.02277, 0.02585, 0.02907, 0.03261, 0.03649, 0.04027, 0.04313, 0.04448, 0.04458, 0.04476, 0.04689, 0.05232, 0.06097, 0.07126, 0.08097, 0.08852, 0.09376, 0.09771, 0.10159, 0.10579, 0.10976, 0.11289, 0.11559, 0.11961, 0.12707, 0.13882, 0.15332, 0.16706, 0.17645, 0.18003, 0.17942, 0.17838, 0.18053, 0.18729, 0.19755, 0.20892, 0.21966, 0.22960, 0.23957, 0.24994, 0.25972, 0.26710, 0.27116, 0.27324, 0.27673, 0.28511, 0.29963, 0.31823, 0.33675, 0.35139, 0.36086, 0.36679, 0.37215, 0.37919, 0.38824, 0.39810, 0.40732, 0.41529, 0.42222, 0.42833, 0.43331, 0.43642, 0.43736, 0.43695, 0.43692, 0.43905, 0.44410, 0.45157, 0.46032, 0.46950, 0.47910, 0.48963, 0.50134, 0.51357, 0.52488, 0.53383, 0.53989, 0.54381, 0.54710, 0.55100, 0.55550, 0.55924, 0.56025, 0.55724, 0.55050, 0.54185, 0.53376, 0.52811, 0.52551, 0.52556, 0.52767, 0.53176, 0.53817, 0.54692, 0.55706, 0.56667, 0.57390, 0.57802, 0.57991, 0.58132, 0.58363, 0.58698, 0.59040, 0.59284, 0.59398, 0.59422, 0.59382, 0.59219, 0.58807, 0.58077, 0.57129, 0.56240, 0.55738, 0.55812, 0.56408, 0.57267, 0.58080, 0.58641, 0.58929, 0.59066, 0.59223, 0.59533, 0.60047, 0.60757, 0.61646, 0.62727, 0.64014, 0.65435, 0.66763, 0.67647, 0.67794, 0.67179, 0.66144, 0.65261, 0.65053, 0.65738, 0.67182, 0.69033, 0.70908, 0.72504, 0.73619, 0.74131, 0.74007, 0.73303, 0.72154, 0.70773, 0.69483, 0.68717, 0.68903, 0.70222, 0.72415, 0.74864, 0.76952, 0.78424, 0.79431, 0.80228, 0.80857, 0.81164, 0.81102, 0.80961, 0.81179, 0.81913, 0.82823, 0.83337, 0.83166, 0.82545, 0.81976, 0.81769, 0.81841, 0.81924, 0.81885, 0.81815, 0.81867, 0.82081, 0.82416, 0.82876, 0.83544, 0.84443, 0.85420, 0.86217, 0.86666, 0.86812, 0.86825, 0.86826, 0.86815, 0.86754, 0.86685, 0.86720, 0.86929, 0.87247, 0.87537, 0.87704, 0.87765, 0.87783, 0.87791];
        
        // Data for "Worst State" Chart
        const worstQChopTimeData = [0.00, 2.50, 5.00, 7.50, 10.00, 12.50, 15.00, 17.50, 20.00, 22.50, 25.00, 27.50, 30.00, 32.50, 35.00, 37.50, 40.00, 42.50, 45.00, 47.50, 50.00, 52.50, 55.00, 57.50, 60.00, 62.50, 65.00, 67.50, 70.00, 72.50, 75.00, 77.50, 80.00, 82.50, 85.00, 87.50, 90.00, 92.50, 95.00, 97.50, 100.00, 102.50, 105.00, 107.50, 110.00, 112.50, 115.00, 117.50, 120.00, 122.50, 125.00, 127.50, 130.00, 132.50, 135.00, 137.50, 140.00, 142.50, 145.00, 147.50, 150.00, 152.50, 155.00, 157.50, 160.00, 162.50, 165.00, 167.50, 170.00, 172.50, 175.00, 177.50, 180.00, 182.50, 185.00, 187.50, 190.00, 192.50, 195.00, 197.50, 200.00, 202.50, 205.00, 207.50, 210.00, 212.50, 215.00, 217.50, 220.00, 222.50, 225.00, 227.50, 230.00, 232.50, 235.00, 237.50, 240.00, 242.50, 245.00, 247.50, 250.00, 252.50, 255.00, 257.50, 260.00, 262.50, 265.00, 267.50, 270.00, 272.50, 275.00, 277.50, 280.00, 282.50, 285.00, 287.50, 290.00, 292.50, 295.00, 297.50, 300.00, 302.50, 305.00, 307.50, 310.00, 312.50, 315.00, 317.50, 320.00, 322.50, 325.00, 327.50, 330.00, 332.50, 335.00, 337.50, 340.00, 342.50, 345.00, 347.50, 350.00, 352.50, 355.00, 357.50, 360.00, 362.50, 365.00, 367.50, 370.00, 372.50, 375.00, 377.50, 380.00, 382.50, 385.00, 387.50, 390.00, 392.50, 395.00, 397.50, 400.00, 402.50, 405.00, 407.50, 410.00, 412.50, 415.00, 417.50, 420.00, 422.50, 425.00, 427.50, 430.00, 432.50, 435.00, 437.50, 440.00, 442.50, 445.00, 447.50, 450.00, 452.50, 455.00, 457.50, 460.00, 462.50, 465.00, 467.50, 470.00, 472.50, 475.00, 477.50, 480.00, 482.50, 485.00, 487.50, 490.00, 492.50, 495.00, 497.50, 500.00, 500.00, 502.50, 505.00, 507.50, 510.00, 512.50, 515.00, 517.50, 520.00, 522.50, 525.00, 527.50, 530.00, 532.50, 535.00, 537.50, 540.00, 542.50, 545.00, 547.50, 550.00, 552.50, 555.00, 557.50, 560.00, 562.50, 565.00, 567.50, 570.00, 572.50, 575.00, 577.50, 580.00, 582.50, 585.00, 587.50, 590.00, 592.50, 595.00, 597.50, 600.00, 602.50, 605.00, 607.50, 610.00, 612.50, 615.00, 617.50, 620.00, 622.50, 625.00, 627.50, 630.00, 632.50, 635.00, 637.50, 640.00, 642.50, 645.00, 647.50, 650.00, 652.50, 655.00, 657.50, 660.00, 662.50, 665.00, 667.50, 670.00, 672.50, 675.00, 677.50, 680.00, 682.50, 685.00, 687.50, 690.00, 692.50, 695.00, 697.50, 700.00, 702.50, 705.00, 707.50, 710.00, 712.50, 715.00, 717.50, 720.00, 722.50, 725.00, 727.50, 730.00, 732.50, 735.00, 737.50, 740.00, 742.50, 745.00, 747.50, 750.00, 752.50, 755.00, 757.50, 760.00, 762.50, 765.00, 767.50, 770.00, 772.50, 775.00, 777.50, 780.00, 782.50, 785.00, 787.50, 790.00, 792.50, 795.00, 797.50, 800.00, 802.50, 805.00, 807.50, 810.00, 812.50, 815.00, 817.50, 820.00, 822.50, 825.00, 827.50, 830.00, 832.50, 835.00, 837.50, 840.00, 842.50, 845.00, 847.50, 850.00, 852.50, 855.00, 857.50, 860.00, 862.50, 865.00, 867.50, 870.00, 872.50, 875.00, 877.50, 880.00, 882.50, 885.00, 887.50, 890.00, 892.50, 895.00, 897.50, 900.00, 902.50, 905.00, 907.50, 910.00, 912.50, 915.00, 917.50, 920.00, 922.50, 925.00, 927.50, 930.00, 932.50, 935.00, 937.50, 940.00, 942.50, 945.00, 947.50, 950.00, 952.50, 955.00, 957.50, 960.00, 962.50, 965.00, 967.50, 970.00, 972.50, 975.00, 977.50, 980.00, 982.50, 985.00, 987.50, 990.00, 992.50, 995.00, 997.50, 1000.00];
        const worstQChopRun1Data = [0.636787, 0.636787, 0.636777, 0.636736, 0.636627, 0.636405, 0.636017, 0.635409, 0.634529, 0.633335, 0.631796, 0.629904, 0.627669, 0.625132, 0.622357, 0.619437, 0.616489, 0.613646, 0.611055, 0.60886, 0.607193, 0.606157, 0.605816, 0.606177, 0.607185, 0.608715, 0.610578, 0.612535, 0.614325, 0.615696, 0.616453, 0.616507, 0.615909, 0.61488, 0.613806, 0.613193, 0.61359, 0.615474, 0.619126, 0.624529, 0.631328, 0.638879, 0.646404, 0.653218, 0.658962, 0.663723, 0.667973, 0.672288, 0.676924, 0.681472, 0.684815, 0.685559, 0.682826, 0.677019, 0.670003, 0.664328, 0.661729, 0.66177, 0.661795, 0.658675, 0.651505, 0.643196, 0.639188, 0.643518, 0.65512, 0.667836, 0.674932, 0.674484, 0.67033, 0.667021, 0.663797, 0.654693, 0.63566, 0.610697, 0.588647, 0.573234, 0.558891, 0.539302, 0.518524, 0.508602, 0.514369, 0.525472, 0.528198, 0.521887, 0.516317, 0.513976, 0.505252, 0.485455, 0.4666, 0.46274, 0.4705, 0.476606, 0.480465, 0.493388, 0.51495, 0.527833, 0.52272, 0.512238, 0.509886, 0.509897, 0.502141, 0.494323, 0.500822, 0.51717, 0.525434, 0.521622, 0.518001, 0.51791, 0.508362, 0.483165, 0.455727, 0.439337, 0.428571, 0.412181, 0.394241, 0.388174, 0.394409, 0.398069, 0.389381, 0.374701, 0.363393, 0.353108, 0.335449, 0.311555, 0.293765, 0.291501, 0.30135, 0.313542, 0.324457, 0.338867, 0.360804, 0.385899, 0.404373, 0.410317, 0.406562, 0.400793, 0.398088, 0.397502, 0.394841, 0.387684, 0.377666, 0.368612, 0.363019, 0.360147, 0.356959, 0.350671, 0.340763, 0.329163, 0.318835, 0.311958, 0.308824, 0.307922, 0.306881, 0.303624, 0.297145, 0.287674, 0.276327, 0.264528, 0.253487, 0.243896, 0.235888, 0.229184, 0.223319, 0.21785, 0.212495, 0.207179, 0.202013, 0.197219, 0.193055, 0.189746, 0.187434, 0.186164, 0.185881, 0.186451, 0.187686, 0.189369, 0.19128, 0.193213, 0.194991, 0.196471, 0.197551, 0.198163, 0.198278, 0.197896, 0.197043, 0.195768, 0.194135, 0.192219, 0.190103, 0.187874, 0.185614, 0.183404, 0.181316, 0.17941, 0.177735, 0.176325, 0.1752, 0.174362, 0.173801, 0.173493, 0.173399, 0.000000];
        const worstQChopRun2Data = [0.000003, 0.000055, 0.000268, 0.000805, 0.001843, 0.003532, 0.005956, 0.009113, 0.012893, 0.017097, 0.021454, 0.025667, 0.029461, 0.032633, 0.035093, 0.036885, 0.038191, 0.039305, 0.040589, 0.042413, 0.045096, 0.048846, 0.053726, 0.059646, 0.066383, 0.07363, 0.081058, 0.088391, 0.095457, 0.102222, 0.108784, 0.115338, 0.122107, 0.129273, 0.136915, 0.14498, 0.153296, 0.161627, 0.169752, 0.177547, 0.185042, 0.192423, 0.199983, 0.208025, 0.21675, 0.22618, 0.236127, 0.246256, 0.256194, 0.265672, 0.274625, 0.283217, 0.291758, 0.300551, 0.309718, 0.31909, 0.328228, 0.336573, 0.343687, 0.34948, 0.35431, 0.358902, 0.364077, 0.370408, 0.377945, 0.386138, 0.394024, 0.4006, 0.405245, 0.407973, 0.40943, 0.410603, 0.4124, 0.41528, 0.419131, 0.423417, 0.427505, 0.43099, 0.43383, 0.436252, 0.438495, 0.440604, 0.442405, 0.443703, 0.44456, 0.445452, 0.447144, 0.450305, 0.455055, 0.460755, 0.466196, 0.470171, 0.472144, 0.472631, 0.473058, 0.475103, 0.479851, 0.487204, 0.495884, 0.504032, 0.510104, 0.513585, 0.515153, 0.516232, 0.518203, 0.521716, 0.526474, 0.53155, 0.53603, 0.539556, 0.542487, 0.545586, 0.54948, 0.554213, 0.559187, 0.563503, 0.56651, 0.56822, 0.569357, 0.571011, 0.57409, 0.578881, 0.584943, 0.591382, 0.597328, 0.602373, 0.606728, 0.61105, 0.616057, 0.622147, 0.629223, 0.636798, 0.644296, 0.651388, 0.658165, 0.665072, 0.672643, 0.68117, 0.69048, 0.699932, 0.708628, 0.71577, 0.720982, 0.72448, 0.727025, 0.72967, 0.73341, 0.738864, 0.746089, 0.754583, 0.763459, 0.771715, 0.778515, 0.783388, 0.786311, 0.787659, 0.788069, 0.788264, 0.788883, 0.790368, 0.792919, 0.796505, 0.800926, 0.805887, 0.811069, 0.816189, 0.821027, 0.82544, 0.829358, 0.832775, 0.835731, 0.838308, 0.840614, 0.842781, 0.844947, 0.847256, 0.849837, 0.852797, 0.856206, 0.860094, 0.864447, 0.869208, 0.874283, 0.879559, 0.884908, 0.890202, 0.895329, 0.900194, 0.904726, 0.908879, 0.912627, 0.915965, 0.918897, 0.921432, 0.92358, 0.925347, 0.926734, 0.927737, 0.928346, 0.928551];
        
        // Shared Data
        const adiabaticTimeData = [0.00, 5.00, 10.00, 15.00, 20.00, 25.00, 30.00, 35.00, 40.00, 45.00, 50.00, 55.00, 60.00, 65.00, 70.00, 75.00, 80.00, 85.00, 90.00, 95.00, 100.00, 105.00, 110.00, 115.00, 120.00, 125.00, 130.00, 135.00, 140.00, 145.00, 150.00, 155.00, 160.00, 165.00, 170.00, 175.00, 180.00, 185.00, 190.00, 195.00, 200.00, 205.00, 210.00, 215.00, 220.00, 225.00, 230.00, 235.00, 240.00, 245.00, 250.00, 255.00, 260.00, 265.00, 270.00, 275.00, 280.00, 285.00, 290.00, 295.00, 300.00, 305.00, 310.00, 315.00, 320.00, 325.00, 330.00, 335.00, 340.00, 345.00, 350.00, 355.00, 360.00, 365.00, 370.00, 375.00, 380.00, 385.00, 390.00, 395.00, 400.00, 405.00, 410.00, 415.00, 420.00, 425.00, 430.00, 435.00, 440.00, 445.00, 450.00, 455.00, 460.00, 465.00, 470.00, 475.00, 480.00, 485.00, 490.00, 495.00, 500.00, 505.00, 510.00, 515.00, 520.00, 525.00, 530.00, 535.00, 540.00, 545.00, 550.00, 555.00, 560.00, 565.00, 570.00, 575.00, 580.00, 585.00, 590.00, 595.00, 600.00, 605.00, 610.00, 615.00, 620.00, 625.00, 630.00, 635.00, 640.00, 645.00, 650.00, 655.00, 660.00, 665.00, 670.00, 675.00, 680.00, 685.00, 690.00, 695.00, 700.00, 705.00, 710.00, 715.00, 720.00, 725.00, 730.00, 735.00, 740.00, 745.00, 750.00, 755.00, 760.00, 765.00, 770.00, 775.00, 780.00, 785.00, 790.00, 795.00, 800.00, 805.00, 810.00, 815.00, 820.00, 825.00, 830.00, 835.00, 840.00, 845.00, 850.00, 855.00, 860.00, 865.00, 870.00, 875.00, 880.00, 885.00, 890.00, 895.00, 900.00, 905.00, 910.00, 915.00, 920.00, 925.00, 930.00, 935.00, 940.00, 945.00, 950.00, 955.00, 960.00, 965.00, 970.00, 975.00, 980.00, 985.00, 990.00, 995.00, 1000.00];
        const adiabaticData = [0.331846, 0.333523, 0.335187, 0.33684, 0.338485, 0.340132, 0.341786, 0.343442, 0.345071, 0.346655, 0.348238, 0.349868, 0.351479, 0.353017, 0.354606, 0.356204, 0.357715, 0.359313, 0.360831, 0.362382, 0.363912, 0.365437, 0.36695, 0.368479, 0.369951, 0.371497, 0.372941, 0.374451, 0.375948, 0.377375, 0.378869, 0.380355, 0.381773, 0.383211, 0.384688, 0.386142, 0.387552, 0.388953, 0.390376, 0.391816, 0.393249, 0.394659, 0.396047, 0.397426, 0.398804, 0.400184, 0.401566, 0.402948, 0.404329, 0.405707, 0.40708, 0.408446, 0.409806, 0.411161, 0.41251, 0.413856, 0.415197, 0.416533, 0.417865, 0.419192, 0.420515, 0.421833, 0.423148, 0.424459, 0.425766, 0.427069, 0.428368, 0.429661, 0.43095, 0.432233, 0.433512, 0.434788, 0.436062, 0.437336, 0.438613, 0.439893, 0.441175, 0.442453, 0.443721, 0.444972, 0.446206, 0.447435, 0.448677, 0.449939, 0.451203, 0.452438, 0.453642, 0.454855, 0.456106, 0.45735, 0.45854, 0.459734, 0.460982, 0.46219, 0.463354, 0.464586, 0.465788, 0.466941, 0.468172, 0.46933, 0.470511, 0.471707, 0.472845, 0.474053, 0.475173, 0.476376, 0.477488, 0.47868, 0.479789, 0.480958, 0.482084, 0.483206, 0.484363, 0.485452, 0.48659, 0.48771, 0.488796, 0.489918, 0.49102, 0.492091, 0.493189, 0.494294, 0.495364, 0.496416, 0.497484, 0.498566, 0.499639, 0.50069, 0.501724, 0.502755, 0.503794, 0.504832, 0.505868, 0.5069, 0.507921, 0.508937, 0.509946, 0.510947, 0.511947, 0.512942, 0.513932, 0.514918, 0.515901, 0.516881, 0.517855, 0.518823, 0.519786, 0.520746, 0.521707, 0.522675, 0.523642, 0.524614, 0.525585, 0.526551, 0.527505, 0.528463, 0.529434, 0.530421, 0.531413, 0.532396, 0.53338, 0.534383, 0.535409, 0.536445, 0.537486, 0.538541, 0.539625, 0.540745, 0.541877, 0.543029, 0.544231, 0.545481, 0.546764, 0.54809, 0.549487, 0.550959, 0.552498, 0.554117, 0.555851, 0.55771, 0.559695, 0.561839, 0.564174, 0.566734, 0.569554, 0.572679, 0.576178, 0.580133, 0.584637, 0.589816, 0.595836, 0.602918, 0.611358, 0.621543, 0.634038, 0.649626, 0.669444, 0.694953, 0.727287, 0.763624, 0.785371];
        
        // --- UI ELEMENT REFERENCES ---
        const initializeBtn = document.getElementById('initializeBtn');
        const startRun1Btn = document.getElementById('startRun1Btn');
        const startRun2Btn = document.getElementById('startRun2Btn');
        const bestCtx = document.getElementById('bestStateChart').getContext('2d');
        const worstCtx = document.getElementById('worstStateChart').getContext('2d');
        
        // --- CHART STATE ---
        let bestStateChart, worstStateChart;
        let animationInterval;

        // --- BASE CHART CONFIGURATION ---
        const createBaseConfig = () => ({
            type: 'line',
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { type: 'linear', min: 0, max: 1000, title: { display: true, text: 'Time', color: '#DDDDDD', font: { size: 14 } }, ticks: { color: '#AAAAAA' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                    y: { min: 0, max: 1.0, title: { display: true, text: 'Approximation Ratio (higher is better)', color: '#DDDDDD', font: { size: 14 } }, ticks: { color: '#AAAAAA' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { mode: 'index', intersect: false, backgroundColor: '#2A2A2A', titleFont: { size: 14 }, bodyFont: { size: 12 } }
                },
                animation: { duration: 35 }
            },
            plugins: [{
                id: 'customAnnotations',
                afterDraw: (chart) => {
                    const plugin = chart.options.plugins.customAnnotations;
                    if (plugin && plugin.annotations) {
                        plugin.annotations.forEach(annotation => drawAnnotation(chart, annotation));
                    }
                }
            }]
        });

        // --- ANNOTATION DRAWING FUNCTION ---
        function drawAnnotation(chart, annotation) {
            const { ctx } = chart;
            ctx.save();
            if (annotation.type === 'point') {
                const meta = chart.getDatasetMeta(annotation.datasetIndex);
                if (!meta.data[annotation.pointIndex]) { ctx.restore(); return; }
                const { x, y } = meta.data[annotation.pointIndex].getProps(['x', 'y'], true);
                ctx.font = 'bold 13px Inter';
                ctx.fillStyle = annotation.color;
                ctx.textAlign = annotation.textAlign || 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(annotation.text, x + annotation.offsetX, y + annotation.offsetY);
                ctx.beginPath();
                ctx.moveTo(x + annotation.arrowFromX, y + annotation.arrowFromY);
                ctx.lineTo(x, y);
                ctx.strokeStyle = annotation.color;
                ctx.lineWidth = 2;
                ctx.stroke();
                const angle = Math.atan2(y - (y + annotation.arrowFromY), x - (x + annotation.arrowFromX));
                ctx.beginPath();
                ctx.moveTo(x, y);
                ctx.lineTo(x - 10 * Math.cos(angle - Math.PI / 6), y - 10 * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(x - 10 * Math.cos(angle + Math.PI / 6), y - 10 * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fill();
            } else if (annotation.type === 'textBlock') {
                const xPos = chart.scales.x.getPixelForValue(annotation.x);
                const yPos = chart.scales.y.getPixelForValue(annotation.y);
                ctx.font = annotation.font;
                ctx.fillStyle = annotation.color;
                ctx.textAlign = annotation.textAlign;
                ctx.textBaseline = 'top';
                annotation.text.forEach((line, index) => {
                    ctx.fillText(line, xPos, yPos + (index * 22));
                });
            }
            ctx.restore();
        }

        // --- UI AND ANIMATION LOGIC ---
        function initialize() {
            if (animationInterval) clearInterval(animationInterval);
            if (bestStateChart) bestStateChart.destroy();
            if (worstStateChart) worstStateChart.destroy();

            // Config for Best State Chart
            const bestConfig = createBaseConfig();
            bestConfig.data = {
                datasets: [
                    { label: 'Q-CHOP', data: [{ x: bestTimeData[0], y: bestQChopData[0] }], borderColor: '#76b900', backgroundColor: 'rgba(118, 185, 0, 0.1)', borderWidth: 3, pointRadius: 3, tension: 0.1 },
                    { label: 'Standard Adiabatic', data: [{ x: adiabaticTimeData[0], y: adiabaticData[0] }], borderColor: '#a0a0a0', backgroundColor: 'rgba(160, 160, 160, 0.1)', borderWidth: 2, pointRadius: 3, borderDash: [5, 5], tension: 0.1 }
                ]
            };
            bestConfig.options.plugins.customAnnotations = { 
                annotations: [
                    { type: 'point', text: 'ground state of H_initial', datasetIndex: 1, pointIndex: 0, color: '#a0a0a0', textAlign: 'left', offsetX: 20, offsetY: 20, arrowFromX: 40, arrowFromY: 40 },
                    { type: 'point', text: 'Feasible state', datasetIndex: 0, pointIndex: 0, color: '#76b900', textAlign: 'left', offsetX: 15, offsetY: -15, arrowFromX: 30, arrowFromY: -30 }
                ] 
            };
            
            // Config for Worst State Chart
            const worstConfig = createBaseConfig();
            worstConfig.data = {
                datasets: [
                    { label: 'Q-CHOP Run 1', data: [{ x: worstQChopTimeData[0], y: worstQChopRun1Data[0] }], borderColor: '#76b900', backgroundColor: 'rgba(118, 185, 0, 0.1)', borderWidth: 3, pointRadius: 3, tension: 0.1 },
                    { label: 'Q-CHOP Run 2', data: [], borderColor: '#7a00ff', backgroundColor: 'rgba(122, 0, 255, 0.1)', borderWidth: 3, pointRadius: 3, tension: 0.1 },
                    { label: 'Standard Adiabatic', data: [{ x: adiabaticTimeData[0], y: adiabaticData[0] }], borderColor: '#a0a0a0', backgroundColor: 'rgba(160, 160, 160, 0.1)', borderWidth: 2, pointRadius: 3, borderDash: [5, 5], tension: 0.1 }
                ]
            };
            worstConfig.options.plugins.customAnnotations = { 
                annotations: [
                    { type: 'point', text: 'ground state of H_initial', datasetIndex: 2, pointIndex: 0, color: '#a0a0a0', textAlign: 'left', offsetX: 20, offsetY: 20, arrowFromX: 40, arrowFromY: 40 },
                    { type: 'point', text: 'Feasible state', datasetIndex: 0, pointIndex: 0, color: '#76b900', textAlign: 'left', offsetX: 15, offsetY: -15, arrowFromX: 30, arrowFromY: -30 }
                ] 
            };

            bestStateChart = new Chart(bestCtx, bestConfig);
            worstStateChart = new Chart(worstCtx, worstConfig);

            initializeBtn.disabled = true;
            initializeBtn.classList.add('hidden');

            startRun1Btn.disabled = false;
            startRun1Btn.classList.remove('hidden');
            startRun2Btn.classList.add('hidden');
        }

        function runStage1() {
            startRun1Btn.disabled = true;
            
            bestStateChart.options.plugins.customAnnotations.annotations = [];
            worstStateChart.options.plugins.customAnnotations.annotations = [];
            bestStateChart.update('none');
            worstStateChart.update('none');

            let masterIndex = 1;
            const animationSpeed = 35;

            animationInterval = setInterval(() => {
                let stopCondition = masterIndex >= worstQChopRun1Data.length;

                if (stopCondition) {
                    clearInterval(animationInterval);
                    worstStateChart.options.plugins.customAnnotations.annotations.push({
                        type: 'point', text: 'sample worst feasible state', datasetIndex: 0, pointIndex: worstQChopRun1Data.length - 1,
                        color: '#FFFFFF', textAlign: 'left', offsetX: -200, offsetY: -20, arrowFromX: -180, arrowFromY: -10
                    });
                    worstStateChart.update();

                    startRun1Btn.classList.add('hidden');
                    startRun2Btn.classList.remove('hidden');
                    startRun2Btn.disabled = false;
                    
                    initializeBtn.classList.remove('hidden');
                    initializeBtn.disabled = false;
                    return;
                }
                
                // Animate Best State Chart
                if (masterIndex < bestQChopData.length) {
                    bestStateChart.data.datasets[0].data.push({ x: bestTimeData[masterIndex], y: bestQChopData[masterIndex] });
                }
                 if (masterIndex < adiabaticData.length) {
                    bestStateChart.data.datasets[1].data.push({ x: adiabaticTimeData[masterIndex], y: adiabaticData[masterIndex] });
                }

                // Animate Worst State Chart (Run 1)
                if (masterIndex < worstQChopRun1Data.length) {
                    worstStateChart.data.datasets[0].data.push({ x: worstQChopTimeData[masterIndex], y: worstQChopRun1Data[masterIndex] });
                    const adiabaticPointsForWorst = adiabaticData.slice(0, Math.floor(worstQChopTimeData[masterIndex]/5)+1);
                    worstStateChart.data.datasets[2].data = adiabaticPointsForWorst.map((y, i) => ({x: adiabaticTimeData[i], y:y}));
                }
                
                bestStateChart.update();
                worstStateChart.update();
                masterIndex++;

            }, animationSpeed);
        }

        function runStage2() {
            startRun2Btn.disabled = true;
            worstStateChart.options.plugins.customAnnotations.annotations = [];
            
            const lastPointRun1 = worstStateChart.data.datasets[0].data[worstStateChart.data.datasets[0].data.length - 1];
            worstStateChart.data.datasets[1].data.push(lastPointRun1);
            
            let run2Index = 0;
            const animationSpeed = 35;

            animationInterval = setInterval(() => {
                if (run2Index >= worstQChopRun2Data.length) {
                    clearInterval(animationInterval);
                    return;
                }
                
                const timeDataIndex = worstQChopRun1Data.length + run2Index;
                worstStateChart.data.datasets[1].data.push({ x: worstQChopTimeData[timeDataIndex], y: worstQChopRun2Data[run2Index] });
                
                const adiabaticPointsForWorst = adiabaticData.slice(0, Math.floor(worstQChopTimeData[timeDataIndex]/5)+1);
                worstStateChart.data.datasets[2].data = adiabaticPointsForWorst.map((y, i) => ({x: adiabaticTimeData[i], y:y}));

                worstStateChart.update();
                run2Index++;

            }, animationSpeed);
        }

        // --- INITIAL SETUP ---
        initializeBtn.addEventListener('click', initialize);
        startRun1Btn.addEventListener('click', runStage1);
        startRun2Btn.addEventListener('click', runStage2);
        
        // Initial draw
        initialize();
        // Make initialize button green and visible at the start
        initializeBtn.classList.remove('bg-gray-600', 'hidden');
        initializeBtn.classList.add('nvidia-green', 'text-black');
        initializeBtn.disabled = false;


    </script>
</body>
</html>
